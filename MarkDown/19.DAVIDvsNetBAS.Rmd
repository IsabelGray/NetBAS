---
title: "Side-by-Side Comparison"
author: "HBG"
date: "11/9/2018"
output: pdf_document
---

```{r}
rm(list=ls())
debug = 1
largeGOFlag = 1;
library(foreach)
library(doMC)
registerDoMC(6)

bp.file <- read.csv("19.bp.top10.txt", sep="\t", header=T)
bp.david <- bp.file$z.d
bp.net <- bp.file$z.n
#bp.david.adj <- round(bp.david*16.995/4.453,3)
bp.matrix <- t(rbind(bp.david, bp.net))
rownames(bp.matrix) <- bp.file$id
colnames(bp.matrix) <- c("DAVID", "NetBAS")
bp.matrix <- bp.matrix[order(-bp.matrix[,2]),]

png(filename = "19.bp.DAVIDvsNetBAS.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(bp.matrix, col=my_palette, dendrogram='none', 
          sepcolor="lightgrey", sepwidth = c(0.05,0.01), 
          colsep = 1:2, rowsep = 1:18,
          trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
          ylab="Biological Process Terms", xlab="",
          margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
          scale="none", symbreaks=F, symm=F, symkey = F,
          adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
          cexRow = 0.9, cexCol=1.2,
          cellnote=bp.matrix,
          main="")
dev.off()
png(filename = "19.bp.DAVIDvsNetBAS.tmp.png",width=8, height=3.5, res=1200, unit="in")
heatmap.2(bp.matrix, col=my_palette, dendrogram='none', 
          sepcolor="lightgrey", sepwidth = c(0.05,0.01), 
          colsep = 1:2, rowsep = 1:18,
          trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
          ylab="Biological Process Terms", xlab="",
          margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
          scale="none", symbreaks=F, symm=F, symkey = F,
          adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
          cexRow = 0.9, cexCol=1.2,
          cellnote=bp.matrix,
          main="")
dev.off()

cc.file <- read.csv("19.cc.top10.txt", sep="\t", header=T)
cc.david <- cc.file$z.d
cc.net <- cc.file$z.n
cc.matrix <- t(rbind(cc.david, cc.net))
rownames(cc.matrix) <- cc.file$id
colnames(cc.matrix) <- c("DAVID", "NetBAS")
cc.matrix <- cc.matrix[order(-cc.matrix[,2]),]

png(filename = "19.cc.DAVIDvsNetBAS.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(cc.matrix, col=my_palette, dendrogram='none', 
          sepcolor="lightgrey", sepwidth = c(0.05,0.01), 
          colsep = 1:2, rowsep = 1:18,
          trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
          ylab="Cellular Composition Terms", xlab="",
          margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
          scale="none", symbreaks=F, symm=F, symkey = F,
          adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
          cexRow = 0.9, cexCol=1.2,
          cellnote=cc.matrix,
          main="")
dev.off()
png(filename = "19.cc.DAVIDvsNetBAS.tmp.png",width=8, height=3.5, res=1200, unit="in")
heatmap.2(cc.matrix, col=my_palette, dendrogram='none', 
          sepcolor="lightgrey", sepwidth = c(0.05,0.01), 
          colsep = 1:2, rowsep = 1:18,
          trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
          ylab="Cellular Composition Terms", xlab="",
          margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
          scale="none", symbreaks=F, symm=F, symkey = F,
          adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
          cexRow = 0.9, cexCol=1.2,
          cellnote=cc.matrix,
          main="")
dev.off()

mf.file <- read.csv("19.mf.top10.txt", sep="\t", header=T)
mf.david <- mf.file$z.d
mf.net <- mf.file$z.n
mf.matrix <- t(rbind(mf.david, mf.net))
rownames(mf.matrix) <- mf.file$id
colnames(mf.matrix) <- c("DAVID", "NetBAS")
mf.matrix <- mf.matrix[order(-mf.matrix[,2]),]

png(filename = "19.mf.DAVIDvsNetBAS.png",width=3.5, height=6, res=1200, unit="in")
heatmap.2(mf.matrix, col=my_palette, dendrogram='none', 
          sepcolor="lightgrey", sepwidth = c(0.05,0.01), 
          colsep = 1:2, rowsep = 1:18,
          trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
          ylab="Molecular Function Terms", xlab="",
          margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
          scale="none", symbreaks=F, symm=F, symkey = F,
          adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
          cexRow = 0.9, cexCol=1.2,
          cellnote=mf.matrix,
          main="")
dev.off()
png(filename = "19.mf.DAVIDvsNetBAS.tmp.png",width=8, height=3.5, res=1200, unit="in")
heatmap.2(cc.matrix, col=my_palette, dendrogram='none', 
          sepcolor="lightgrey", sepwidth = c(0.05,0.01), 
          colsep = 1:2, rowsep = 1:18,
          trace='none', Rowv=F, Colv=F, #revC=T, #labCol=NA,
          ylab="Molecular Function Terms", xlab="",
          margins = c(3.2,5), key.title = NA, key.xlab=NA, key.ylab=NA,
          scale="none", symbreaks=F, symm=F, symkey = F,
          adjCol=c(0.5,0), adjRow=c(0.2,0), srtRow=45, srtCol=0,
          cexRow = 0.9, cexCol=1.2,
          cellnote=mf.matrix,
          main="")
dev.off()
```